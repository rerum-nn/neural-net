# Neural network from scratch

```NeuralNet``` -- небольшая библиотека C++20 для работы с полносвязными нейронными сетями прямого распространения.
Поддерживаемый функционал:
- Создание, обучение, подсчет метрик, сохранение в виде файла нейронной сети
- Оптимизаторы ```Adam```, ```RMSprop```, ```AdaGrad```, ```SGD``` для обучения
- Функции потерь ```CrossEntropy```, ```MAE```, ```MSE```
- Функции активации ```ReLU```, ```LeakyReLU```, ```Sigmoid```, ```Softmax```, ```Tanh```
- Разбиение датасета на тренировочную и тестовую выборку
- Преобразование категорий в виде натурального числа в вектор
- Загрузка датасета MNIST из CSV файла

## Пример кода

Все структуры данных и методы находятся в пространстве имен ```neural_net```. Пример кода обучения нейронной сети на данных MNIST можно найти в ```tests/mnist.cpp```

## Сборка и тестирование

Для сборки необходим ```CMake >= 3.19```. Названия таргетов тестов совпадают с названиями файлов. Определен таргет ```all_tests```, запускающий все тесты (кроме ```mnist``` и ```test_deserialize```). 

Для сборки используются ```cmake-presets```, поэтому, для создания собственного профиля сборки необходимо использовать файл ```CMakeUserPresets.json```. Подробнее с ```cmake-presets``` можно ознакомиться на [сайте CMake](https://cmake.org/cmake/help/latest/manual/cmake-presets.7.html). Для установки используемого количество ядер CPU используется макрос ```THREADS``` (необходимо изменить на количество физических ядер CPU; пример сборки с этим макросом смотреть в ```CMakePresets.json```). если ```THREADS``` не определен, то в релизной сборке используется количество логических ядер CPU.
 
Релизная сборка (подходит для тестирования скорости таргета ```mnist```):
```
mkdir build-release && cd build-release
cmake ../ --preset=Release
make mnist && ./tests/mnist
```
Для запуска таргета mnist также необходимы помещенные в каталог с запускаемым файлом CSV файлы с данными. Найти их можно на [Kaggle](https://www.kaggle.com/datasets/oddrationale/mnist-in-csv).

Сборка для тестов:
```
mkdir build-debug && cd build-debug
cmake ../ --preset=Debug
make all_tests && ./tests/all_tests
```
